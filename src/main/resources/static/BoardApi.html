<!DOCTYPE html>
<html>

<head>
    <style>
        /* Trello-style board layout */

        .h1 {
            font-size: 30px;
            font-weight: bolder;
            padding: 10px;
            background-color: #026aa7;
        }

        body {
            font-family: Arial, sans-serif;
            margin: 0;
            padding: 0;
        }

        header {
            margin-left: auto;
            margin: 0;
            text-align: right;
            background-color: #026aa7;
            color: white;
            padding: 10px;
        }

        h3 {
            text-align: left;
            font-family: Arial;

        }

        .board {
            display: flex;
            padding: 20px;
        }

        .column {
            flex: 1;
            background-color: #e2e4e6;
            margin: 0 10px;
            padding: 10px;
            border-radius: 5px;
        }

        .column h2 {
            margin-top: 0;
            margin-bottom: 10px;
            color: #333;
        }

        .card {
            background-color: white;
            border-radius: 5px;
            padding: 10px;
            margin-bottom: 10px;
            box-shadow: 0 2px 4px rgba(0, 0, 0, 0.1);
            cursor: pointer;
        }

        .card p {
            margin: 0;
            color: #333;
        }

        .idDiv {
            font-weight: bolder;
            padding-bottom: 10px;
        }

        .titleDiv {
            padding-bottom: 5px;
            text-decoration: underline;
        }

        form,
        body,
        header,
        main,
        footer,
        .footer-container,
        .control-panel {
            margin: 0;
            padding: 0;
        }

        /* ... (Your other CSS styles for cards, columns, etc.) */

        /* Style the footer container */
        .footer-container {
            display: flex;
            justify-content: space-around;
            background-color: #f9f9f9;
            padding: 20px;
        }

        /* Style each control panel */
        .control-panel {
            flex: 1;
            margin: 10px;
            padding: 10px;
            border: 1px solid #ccc;
            border-radius: 5px;
            background-color: #fff;
        }

        /* Style the section headings */
        .control-panel h3 {
            font-size: 18px;
            margin-bottom: 10px;
        }

        /* Style the form elements */
        .form-group {
            margin-bottom: 10px;
        }

        .form-group input[type="text"],
        .form-group select {
            width: 100%;
            padding: 5px;
            border: 1px solid #ccc;
            border-radius: 5px;
        }

        .form-group input[type="submit"] {
            width: 100%;
            background-color: #007bff;
            color: #fff;
            border: none;
            padding: 10px;
            cursor: pointer;
            border-radius: 5px;
        }

        .form-group input[type="button"] {
            width: 100%;
            background-color: #007bff;
            color: #fff;
            border: none;
            padding: 10px;
            cursor: pointer;
            border-radius: 5px;
        }

        /* .btn-primary {
                width: 100%;
                background-color: #007bff;
                color: #fff;
                border: none;
                padding: 10px;
                cursor: pointer;
                border-radius: 5px;
        } */
    </style>
</head>

<body>
    <script>
        var requestOptions = {
            method: 'GET',
            redirect: 'follow'
        };

        fetch("http://localhost:8080/api/boards/1/cards", requestOptions)
            .then(response => response.json())
            .then(result => {
                result.forEach(api => {

                    let sectitonId = api.section;
                    let boardDiv;

                    if (sectitonId === 1) {
                        boardDiv = document.getElementById("sectionToDo");
                    }
                    else if (sectitonId === 2) {
                        boardDiv = document.getElementById("sectionInProgress");
                    }
                    else {
                        boardDiv = document.getElementById("sectionDone");
                    }

                    let cardDiv = document.createElement("div");
                    cardDiv.className = "card";
                    cardDiv.id = "card" + api.id;

                    let idDiv = document.createElement("div");
                    idDiv.className = "idDiv";
                    idDiv.id = "id" + api.id;
                    idDiv.textContent = "#" + api.id;

                    let titleDiv = document.createElement("div");
                    titleDiv.className = "titleDiv";
                    titleDiv.id = "title-" + api.id;
                    titleDiv.textContent = api.title;

                    let descriptionDiv = document.createElement("div");
                    descriptionDiv.className = "descriptionDiv";
                    descriptionDiv.id = "description-" + api.id;
                    descriptionDiv.textContent = api.description;

                    cardDiv.appendChild(idDiv);
                    cardDiv.appendChild(titleDiv);
                    cardDiv.appendChild(descriptionDiv);

                    boardDiv.appendChild(cardDiv);



                    let deleteSelection = document.getElementById("deletesection");

                    let optionSelect = document.createElement("option");
                    optionSelect.id = "delete" + api.id;
                    optionSelect.textContent = api.id;

                    deleteSelection.appendChild(optionSelect);
                });
            })
            .catch(error => console.log('error', error));
    </script>

    <div id="boardTitle" class="h1"></div>

    <header>
        <div class="header">
            <form id="Title">
                <input type="text" id="newBoardTitle" placeholder="Enter a new board title"
                    oninput="updateInputValue(this)">
                <input type="button" id="updateBtn" onclick="updateBoardTitle()" value="Update">
            </form>
        </div>
    </header>

    <script>
        document.addEventListener("DOMContentLoaded", function () {
            let boardTitleElement = document.getElementById("boardTitle");

            var requestOptions = {
                method: 'GET',
                redirect: 'follow'
            };

            fetch("http://localhost:8080/api/boards/1", requestOptions)
                .then(response => response.json())
                .then(result => boardTitleElement.textContent = result.title)
                .catch(error => console.log('error', error));
        });
    </script>




    <script>
        function updateBoardTitle() {
            let updatedTitle = document.getElementById("newBoardTitle").value;
            var myHeaders = new Headers();
            myHeaders.append("Content-Type", "application/json");

            var raw = JSON.stringify({
                "title": updatedTitle
            });

            var requestOptions = {
                method: 'PUT',
                headers: myHeaders,
                body: raw,
                redirect: 'follow'
            };

            fetch("http://localhost:8080/api/boards/1", requestOptions)
                .then(response => response.text())
                .then(result => location.reload()
                )
                .catch(error => console.log('error', error));
        }
    </script>


    <!-- //////////////////////////////////////////////////////////////////////////////    -->
    <div class="board">
        <div class="column" class="section" id="sectionToDo">
            <h2>To Do</h2>
        </div>
        <div class="column" class="section" id="sectionInProgress">
            <h2>In Progress</h2>
        </div>
        <div class="column" class="section" id="sectionDone">
            <h2>Done</h2>
        </div>
        <footer>
            <div class="control-panel">
                <h5>Create New Card</h5>
                <form class="form-container" id="addCardForm">
                    <div class="form-group">
                        <input type="text" id="newTitle" name="newTitle" placeholder="Enter Title">
                    </div>
                    <div class="form-group">
                        <input type="text" id="newDescription" name="newDescription" placeholder="Enter Description">
                    </div>

                    <div class="form-group">
                        <select id="newsection" required>
                            <option value="0">Select Section</option>
                            <option value="1">To Do</option>
                            <option value="2">In Progress</option>
                            <option value="3">Done</option>
                        </select>
                    </div>
                    <div class="form-group">
                        <input name="submit" type="button" onclick="createCard()" value="Create New Card">
                    </div>
                </form>
            </div>
            <div id="cardsContainer" class="cards-container">
            </div>
            <script>
                function createCard() {
                    let cardTitle = document.getElementById("newTitle").value;
                    let cardDescription = document.getElementById("newDescription").value;
                    let cardSection = document.getElementById("newsection").value;
                    console.log(cardTitle);

                    document.getElementById("newsection").addEventListener("change", function () {
                        cardSection = document.getElementById("newsection").value;
                        console.log(cardSection);
                    });

                    var myHeaders = new Headers();
                    myHeaders.append("Content-Type", "application/json");

                    var raw = JSON.stringify({
                        "title": cardTitle,
                        "description": cardDescription,
                        "section": cardSection
                    });

                    var requestOptions = {
                        method: 'POST',
                        headers: myHeaders,
                        body: raw
                    };

                    fetch("http://localhost:8080/api/boards/1/cards", requestOptions)
                        .then(response => response.json())
                        .then(result => {
                            console.log(result);
                            location.reload();
                        })
                        .catch(error => console.log('error', error));
                }
            </script>
            <!-- ///////////////////////////////////////////////////////////////////////////////// -->
            <br>
            <div class="control-panel">
                <h5>Delete Card</h5>
                <select id="deletesection" required>
                    <option value="0">Select Card</option>
                </select>
                <br>
                <br>
                <div class="form-group">
                    <input id="submit" type="button" onclick="deleteCard()" value="Delete Card">
                </div>
            </div>
            <script>
                function deleteCard() {
                    let deleteSelected = document.getElementById("deletesection").value;
                    var requestOptions = {
                        method: 'DELETE',
                        redirect: 'follow'
                    };

                    fetch("http://localhost:8080/api/boards/1/cards/" + deleteSelected, requestOptions)
                        .then(response => response.text())
                        .then(result => {
                            console.log(result);
                            location.reload();
                        })
                        .catch(error => console.log('error', error));
                }
            </script>
            <br>
            <!-- /////////////////////////////////////////////////////////////////////////////// -->
            <div class="update-card">
                <h5>Update Card Information</h5>
                <form class="update-form" id="updateCardForm">
                    <div class="form-group">
                        <input type="text" id="updateTitle" name="updateTitle" placeholder="Enter New Title">
                    </div>
                    <div class="form-group">
                        <input type="text" id="updateDescription" name="updateDescription"
                            placeholder="Enter New Description">
                    </div>
                    <div class="form-group">
                        <select id="updateSection" required aria-label="Update Section Select">
                            <option value="0">Select Section</option>
                            <option value="1">To Do</option>
                            <option value="2">In Progress</option>
                            <option value="3">Done</option>
                        </select>
                    </div>
                    <div class="form-group">
                        <input id="submit" type="button" onclick="UpdateCard()" value="UpdateCard">
                    </div>
                </form>
            </div>
            <div id="cardsContainer">
            </div>
            <script>
                function UpdateCard() {
                    let updatedId = document.getElementById("deletesection").value;
                    
                    let updatedTitle;
                    if (document.getElementById("updateTitle").value === "") {
                        updatedTitle = document.getElementById("title-" + updatedId).textContent;
                    }
                    else {
                        updatedTitle = document.getElementById("updateTitle").value;
                    }

                    let updatedDescription;
                    if (document.getElementById("updateDescription").value === "") {
                        updatedDescription = document.getElementById("description-" + updatedId).textContent;
                    }
                    else {
                        updatedDescription = document.getElementById("updateDescription").value;
                    }

                    let upadtedSection = document.getElementById("updateSection").value;

                    document.getElementById("updateSection").addEventListener("change", function () {
                        upadtedSection = document.getElementById("updateSection").value;
                    });

                    var myHeaders = new Headers();
                    myHeaders.append("Content-Type", "application/json");

                    var raw = JSON.stringify({
                        "title": updatedTitle,
                        "description": updatedDescription,
                        "section": upadtedSection
                    });

                    var requestOptions = {
                        method: 'PUT',
                        headers: myHeaders,
                        body: raw,
                        redirect: 'follow'
                    };

                    fetch("http://localhost:8080/api/boards/1/cards/" + updatedId, requestOptions)
                        .then(response => response.text())
                        .then(result => console.log(result))
                        .catch(error => console.log('error', error));
                }

            </script>
        </footer>
        <!-- <script src="Board.js"></script> -->
</body>

</html>